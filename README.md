## REST API 기반 주차장 안드로이드 앱 
- **Parking Project** 안드로이드 프로젝트는 **Amazon API Gateway**를 통해서 게시된 REST API를 활용하여 **IoT 벡엔드**와 상호작용.
  ## 기능
  Arduino MKR WiFi 1010에 연결된 조도 센서를 이용해서 차의 유무를 감지한다. 차가 감지되면 차단기가 올라간 이후 시간 카운트가 올라가고 20초 전까지는 요금이 3000원이며 20초 이후론 1초당 1원씩 올라간다.

  Android App을 통해 실시간으로 차를 댄 시간과 요금을 조회할 수 있다.

  App내에서 결제버튼 클릭 시, 차단기가 내려간다.

  지정된 날짜 내 시간대와 요금 로그를 조회할 수 있다. 

 
  관리자가 차가 올때마다 상시로 체크하고 관리하기 번거로우므로, 주차장에 조도센서를 이용하여 차량의 유무와 주차시간 그로인한 요금을 자동으로 알 수 있도록 서비스를 설계했다.

  차량 유무를 확인하는 센서로 조도센서를 사용하면 야간에 어려울 것 같다는 문제를 떠올렸지만 지하주차장은 제한이 없고 실외 주차장이더라도 주차장 내 가로등이 있으니 문제없다는 판단을 내려 조도센서를 선택했다.

  조도센서로 차량이 있던 시간과 측정된 요금 값을 실시간으로 Android App을 통해 볼 수 있게 구현했다.

  App내에서 차가 나가기 위해 결제를 완료하면 관리자가 수동으로 차단기를 제어할 수 있게 하였다.

  추후, 쌓인 로그 데이터로 설정한 시간동안 몇대의 차가 이용했고 차마다 얼마의 요금을 냈는지 알 수 있도록 하였다.

  **요약**
	- 주차 목록 조회 
	- 주차 시간, 요금 조회, 결제
	- 요금 로그 조회

  
![](123.png)
![](build.gradle)

- **IoT 백엔드**는 AWS의 다양한 서비스(AWS IoT Core, AWS Lambda, Amazon DyanmoDB, Amazon SNS, Amazon API Gateway)를 이용해 구축된 IoT 클라우드 플랫폼
	- **AWS IoT Device gateway**를 통해서 연결된 **아두이노 디바이스**(**MKRWiFi1010**)로부터 주기적으로 매 5초마다 주차 요금과 시간 정보를 수신하고, MQTT 프로토콜을 이용하여 **Device shadow** 혹은 **IoT rule** 컴포넌트와 상호작용합니다.
		- **Device shadow**는 **Device gateway**를 통해 디바이스 상태정보를 업데이트하거나 현재 상태정보를 게시합니다.
		- **IoT rule**은 등록된 주제)의 메시지가 수신될 때마다 **AWS Lambda** 함수를 통해서 수신된 메시지를 **Amazon DynamoDB**에 저장
		- 주차 목록을 조회하는 REST API
		- 주차 시간, 요금 정보를 결제하거나 조회하는 REST API
		- 주차 요금 로그 정보를 조회하는 REST API
